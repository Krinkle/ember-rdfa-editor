/* ==================================
   #SAY ANNOTATIONS HOVER
   ================================== */

$say-annotation-width-content : $say-annotation-width - $say-unit !default;


@if $say-hover-annotations == true {
  .rdfa-annotations:not(.show-rdfa-blocks) {
    overflow: hidden;

    .mark-highlight-manual,
    [typeof],
    [property],
    [data-type],
    [data-editor-highlight="true"] {
      &:hover {
        border-bottom-style: solid;
      }

      &:before,
      &:after,
      &:hover:before,
      &:hover:after {
        position: absolute;
        transition: padding $say-transition, opacity $say-transition, left $say-transition, border $say-transition;
      }

      /* showing annotations text */
      &[data-editor-position-level]:before,
      &:hover:before {
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        text-overflow: ellipsis;
        overflow: hidden;
        position: absolute;
        padding-left: $say-unit-small;
        margin-top: $say-unit-tiny/2;
        right: calc(100% + #{$say-unit});
        width: $say-annotation-width-content;
        text-align: right;
        background-color: $say-neutral-lightest;
        opacity: 1;
      }

      // Bright highlighted annotation to the front
      &[data-editor-position-level]:before {
        z-index: $say-z-index-alpha;
      }

      &:not([data-editor-position-level]):hover:before {
        // @TODO: Check what this does
      }

      /* style for lines that accompany annotations */
      &[data-editor-position-level]:after,
      &:hover:after {
        position: absolute;
        content: "";
        display: block;
        height: 100%;
        right: calc(100% - #{$say-unit + $say-unit-small});
        width: $say-unit-large;
        border-right: 1px dashed $say-neutral-light;
        border-top: 1px dashed $say-neutral-light;
        margin-top: -$say-unit-small;
      }

      &:not([data-editor-position-level]):hover:after,
      &:not([data-editor-position-level]):after {
        border-right: 0;
      }

      &[data-editor-position-level="0"]:after {
        border-right: 0;
      }

      /* positioning of annotations (pseudo class elements) */
      [data-editor-highlight="true"],
      [property],
      [typeof] {
        .mark-highlight-manual,
        [data-editor-highlight="true"],
        [data-type],
        [typeof],
        [property] {
          &:after {
            min-height: $say-unit-large;
            height: calc(100% - #{$say-unit-huge*2});
          }
        }
      }

      [property] .mark-highlight-manual,
      [typeof] .mark-highlight-manual,
      [property] [data-editor-highlight="true"],
      [typeof] [data-editor-highlight="true"],
      [property] [property],
      [typeof] [typeof] {
        .mark-highlight-manual,
        [data-editor-highlight="true"],
        [data-type],
        [typeof],
        [property] {
          &:before,
          &:after {
            // margin-top: 8rem;
          }

          &:after {
            min-height: $say-unit-large;
            height: calc(100% - #{$say-unit-huge*2});
          }
        }
      }

      [property] [property] [property],
      [typeof] [typeof] [typeof] {
        .mark-highlight-manual,
        [data-editor-highlight="true"],
        [data-type],
        [typeof],
        [property] {
          &:before,
          &:after {
            // margin-top: 12rem;
          }

          &:after {
            min-height: $say-unit-large;
            height: calc(100% - #{$say-unit-huge*2});
          }
        }
      }

      [property] [property] [property] [property],
      [typeof] [typeof] [typeof] [typeof] {
        .mark-highlight-manual,
        [data-editor-highlight="true"],
        [data-type],
        [typeof],
        [property] {
          &:before,
          &:after {
            // margin-top: 16rem;
          }

          &:after {
            min-height: $say-unit-large;
            height: calc(100% - #{$say-unit-huge*2});
          }
        }
      }

      [property] [property] [property] [property] [property],
      [typeof] [typeof] [typeof] [typeof] [typeof] {
        .mark-highlight-manual,
        [data-editor-highlight="true"],
        [data-type],
        [typeof],
        [property] {
          &:before,
          &:after {
            // margin-top: 20rem;
          }

          &:after {
            min-height: $say-unit-large;
            height: calc(100% - #{$say-unit-huge*2});
          }
        }
      }

      [property] [property] [property] [property] [property] [property],
      [typeof] [typeof] [typeof] [typeof] [typeof] [typeof] {
        .mark-highlight-manual,
        [data-editor-highlight="true"],
        [data-type],
        [typeof],
        [property] {
          &:before,
          &:after {
            // margin-top: 24rem;
          }

          &:after {
            min-height: $say-unit-large;
            height: calc(100% - #{$say-unit-huge*2});
          }
        }
      }

      [property] [property] [property] [property] [property] [property] [property],
      [typeof] [typeof] [typeof] [typeof] [typeof] [typeof] [typeof] {
        .mark-highlight-manual,
        [data-editor-highlight="true"],
        [data-type],
        [typeof],
        [property] {
          &:before,
          &:after {
            // margin-top: 28rem;
          }

          &:after {
            min-height: $say-unit-large;
            height: calc(100% - #{$say-unit-huge*2});
            border-left: 0;
            border-right: 0;
          }
        }
      }
    }

    /* temporary way to reposition annotations for big blocks of text */
    [typeof~="besluit:Besluit"],
    [property="ext:stemmingTable"],
    [property="ext:insertStemmingText"],
    [property="ext:aanwezigenTable"],
    [property="ext:insertAanwezigenText"],
    [property="prov:generated"] > [property="besluit:motivering"],
    [property="prov:generated"] > [property="prov:value"],
    [typeof="besluit:Zitting"],
    [property^="ext"]:not([property="ext:heeftAfwezigeBijAgendapunt"]):not(span),
    [data-editor-highlight="true"]:not(li):not(span),
    [typeof="http://data.vlaanderen.be/ns/besluit#Besluit http://data.vlaanderen.be/ns/besluit#AanvullendReglement"],
    [typeof="besluit:Artikel"],
    [typeof="mobiliteit:Opstelling"] {
      display: block;
      position: relative;
    }

    // /* temporary way to reposition annotations for big blocks of text */
    // [typeof~="besluit:Besluit"],
    // [property="ext:stemmingTable"],
    // [property="ext:insertStemmingText"],
    // [property="ext:aanwezigenTable"],
    // [property="ext:insertAanwezigenText"],
    // [property="prov:generated"] > [property="besluit:motivering"],
    // [property="prov:generated"] > [property="prov:value"],
    // [typeof="besluit:Artikel"] {
    //   &:not([data-flagged-remove]) {
    //     &:before,
    //     &:after {
    //       margin-top: 0rem !important;
    //     }
    //   }

    //   [data-editor-highlight="true"],
    //   [data-type],
    //   [typeof],
    //   [property] {
    //     &:not([data-flagged-remove]) {
    //       &:before,
    //       &:after {
    //         // margin-top: 4rem !important;
    //       }
    //     }
    //   }

    //   [property],
    //   [typeof] {
    //     .mark-highlight-manual,
    //     [data-editor-highlight="true"],
    //     [data-type],
    //     [typeof],
    //     [property] {
    //       &:not([data-flagged-remove]) {
    //         &:before,
    //         &:after {
    //           // margin-top: 8rem !important;
    //         }
    //       }
    //     }
    //   }

    //   [property] [data-editor-highlight="true"],
    //   [typeof] [data-editor-highlight="true"],
    //   [property] [property],
    //   [typeof] [typeof] {
    //     .mark-highlight-manual,
    //     [data-editor-highlight="true"],
    //     [data-type],
    //     [typeof],
    //     [property] {
    //       &:not([data-flagged-remove]) {
    //         &:before,
    //         &:after {
    //           // margin-top: 12rem !important;
    //         }
    //       }
    //     }
    //   }

    //   [property] [property] [property],
    //   [typeof] [typeof] [typeof] {
    //     .mark-highlight-manual,
    //     [data-editor-highlight="true"],
    //     [data-type],
    //     [typeof],
    //     [property] {
    //       &:not([data-flagged-remove]) {
    //         &:before,
    //         &:after {
    //           // margin-top: 16rem !important;
    //         }
    //       }
    //     }
    //   }

    //   [property] [property] [property] [property],
    //   [typeof] [typeof] [typeof] [typeof] {
    //     .mark-highlight-manual,
    //     [data-editor-highlight="true"],
    //     [data-type],
    //     [typeof],
    //     [property] {
    //       &:not([data-flagged-remove]) {
    //         &:before,
    //         &:after {
    //           // margin-top: 20rem !important;
    //         }
    //       }
    //     }
    //   }

    //   [property] [property] [property] [property] [property],
    //   [typeof] [typeof] [typeof] [typeof] [typeof] {
    //     .mark-highlight-manual,
    //     [data-editor-highlight="true"],
    //     [data-type],
    //     [typeof],
    //     [property] {
    //       &:not([data-flagged-remove]) {
    //         &:before,
    //         &:after {
    //           // margin-top: 24rem !important;
    //         }
    //       }
    //     }
    //   }

    //   [property] [property] [property] [property] [property] [property],
    //   [typeof] [typeof] [typeof] [typeof] [typeof] [typeof] {
    //     .mark-highlight-manual,
    //     [data-editor-highlight="true"],
    //     [data-type],
    //     [typeof],
    //     [property] {
    //       &:not([data-flagged-remove]) {
    //         &:before,
    //         &:after {
    //           // margin-top: 28rem !important;
    //         }
    //       }
    //     }
    //   }

    //   [property] [property] [property] [property] [property] [property] [property],
    //   [typeof] [typeof] [typeof] [typeof] [typeof] [typeof] [typeof] {
    //     .mark-highlight-manual,
    //     [data-editor-highlight="true"],
    //     [data-type],
    //     [typeof],
    //     [property] {
    //       &:not([data-flagged-remove]) {
    //         &:before,
    //         &:after {
    //           // margin-top: 32rem;
    //         }
    //       }
    //     }
    //   }
    // }

    /* making sure list items annotations look good too */
    ul:not(.article-list) {
      .mark-highlight-manual,
      [typeof],
      [property],
      [data-type],
      [data-editor-highlight="true"] {
        &:not([data-editor-position-level]):hover:before {
          // left: -26.5rem;
          // left: -$say-unit-small * 5;
        }

        &:not([data-editor-position-level]):hover:after {
          // left: -10.5rem;
          // left: -$say-unit-small * 3;
        }

        &[data-editor-position-level]:before {
          // left: -25.5rem;
          // left: -$say-unit-small * 4;
        }

        &[data-editor-position-level]:after {
          // left: -9.5rem;
          // left: -$say-unit-small * 2;
        }
      }
    }
  }

  /* display roadsign details */
  .rdfa-annotations:not(.show-rdfa-blocks) [prefix="mobiliteit: https://data.vlaanderen.be/ns/mobiliteit# infrastructuur: https://data.vlaanderen.be/ns/openbaardomein/infrastructuur# besluit: https://data.vlaanderen.be/ns/besluit# geosparql: http://www.opengis.net/ont/geosparql# locn: http://www.w3.org/ns/locn# xsd:http://www.w3.org/2001/XMLSchema# foaf: http://xmlns.com/foaf/0.1/"] {
    [typeof="mobiliteit:Opstelling"] {
      display: none;
    }
  }

  .rdfa-annotations.show-rdfa-blocks [prefix="mobiliteit: https://data.vlaanderen.be/ns/mobiliteit# infrastructuur: https://data.vlaanderen.be/ns/openbaardomein/infrastructuur# besluit: https://data.vlaanderen.be/ns/besluit# geosparql: http://www.opengis.net/ont/geosparql# locn: http://www.w3.org/ns/locn# xsd:http://www.w3.org/2001/XMLSchema# foaf: http://xmlns.com/foaf/0.1/"] {
    [typeof="mobiliteit:Opstelling"] {
      display: block !important;
    }
  }
}
